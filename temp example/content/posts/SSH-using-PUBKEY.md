---
title: "SSH Using PUBKEY"
date: 2020-03-12T15:37:46+08:00
draft: false
---

Secure Shell (SSH) æ˜¯ä¸€ç¨®åŠ å¯†çš„ç¶²çµ¡å‚³è¼¸å”è­°ï¼Œå¯åœ¨ä¸å®‰å…¨çš„ç¶²çµ¡ä¸­ç‚ºç¶²çµ¡æœå‹™æä¾›å®‰å…¨çš„å‚³è¼¸ç’°å¢ƒ

å»¢è©±ä¸å¤šï¼Œç›´æ¥é–‹å§‹

<!--more-->

# é‡‘é‘°ç”Ÿæˆ

## ç®—æ³•é¸æ“‡

å»ºè­°Switchåˆ°[Ed25519](https://ed25519.cr.yp.to/)

- **ğŸš¨ DSA:** ä¸å®‰å…¨ï¼ŒOpenSSH version 7é–‹å§‹ä¸å†æ”¯æŒ
- **âš ï¸ RSA:** æ ¹æ“šé‡‘é‘°key sizeæ±ºå®šï¼Œ3072å’Œ4096 ğŸ˜€. å…¶ä»–çš„éƒ½éœ€è¦å‡ç´šï¼Œ1024bitçš„æœƒè¢«èªçˆ²æ˜¯unsafeçš„
- **ğŸ‘€ ECDSA:** ECDSAä½¿ç”¨çš„NISTæ›²ç·šä¸Šæœ‰ä¸€å€‹[å€¼å¾—é—œæ³¨çš„å•é¡Œ](https://www.hyperelliptic.org/tanja/vortraege/20130531.pdf)
- **âœ… Ed25519:** æœ€æ¨è–¦çš„ç”Ÿæˆç®—æ³•

## é‡‘é‘°ç”Ÿæˆ

`ssh-keygen -o  -a 100 -t ed25519 -f ~/.ssh/id_ed25519 -C "ä¸€äº›comment"`

å…¶ä¸­:

- -o: å„²å­˜çˆ²OpenSSHæ ¼å¼ï¼ˆåœ¨å‚³å…¥äº†-t åƒæ•¸å¾Œå¯ä»¥çœç•¥ï¼‰
- -a: KDFï¼ˆé‡‘é‘°æ´¾ç”Ÿå‡½æ•¸ï¼‰é‡è¤‡çš„æ¬¡æ•¸ï¼Œç†è«–ä¸Šæ•¸å€¼è¶Šå¤§ï¼Œæš´åŠ›ç ´è§£é›£åº¦å¢åŠ ï¼Œä½†æ˜¯æœƒå°è‡´é©—è­‰é€Ÿåº¦è®Šæ…¢
- -t: æŒ‡å®šé‡‘é‘°é¡å‹ï¼Œå¦‚ed25519
- -f: è¼¸å‡ºæ–‡ä»¶ä»¥åŠä½ç½®
- -C: è¨»é‡‹ï¼Œéš¨ä¾¿å¯«

## å®‰è£…å…¬é’¥

é”®å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œåœ¨æœåŠ¡å™¨ä¸Šå®‰è£…å…¬é’¥ï¼š

```
cd .ssh
cat id_rsa.pub >> authorized_keys
```

è«‹ä¿®æ”¹æ¬Šé™

```
chmod 600 authorized_keys
chmod 700 ~/.ssh
```

ç¼–è¾‘`/etc/ssh/sshd_config` æ–‡ä»¶

```
RSAAuthentication yes
PubkeyAuthentication yes
```

çµ¦äºˆrootç”¨æˆ¶ç™»éŒ„æ¬Šé™

```
PermitRootLogin yes
```

æ¸¬è©¦å®Œæˆä¹‹å¾Œä½¿ç”¨
`PasswordAuthentication no`
å®Œæˆä¹‹å¾Œé‡å•“sshæœå‹™
`service sshd restart`